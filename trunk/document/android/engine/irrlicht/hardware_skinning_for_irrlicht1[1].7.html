<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="copyright" content="2000, 2002, 2005, 2007 phpBB Group" />
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7; IE=EmulateIE9" />

<title>Irrlicht Engine &bull; View topic - Hardware Skinning for Irrlicht 1.7</title>

<link rel="alternate" type="application/atom+xml" title="Feed - Irrlicht Engine" href="http://irrlicht.sourceforge.net/forum/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - News" href="http://irrlicht.sourceforge.net/forum/feed.php?mode=news" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="http://irrlicht.sourceforge.net/forum/feed.php?mode=forums" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="http://irrlicht.sourceforge.net/forum/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - Code Snippets" href="http://irrlicht.sourceforge.net/forum/feed.php?f=9" />

<!--
	phpBB style name: prosilver
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:

	NOTE: This page was generated by phpBB, the free open-source bulletin board package.
	      The phpBB Group is not responsible for the content of this page and forum. For more information
	      about phpBB please visit http://www.phpbb.com
-->

<script type="text/javascript">
// <![CDATA[
	var jump_page = 'Enter the page number you wish to go to:';
	var on_page = '1';
	var per_page = '15';
	var base_url = './viewtopic.php?f=9&amp;t=42096&amp;sid=ba7a0815ac695ac3bd2849a4147d3342';
	var style_cookie = 'phpBBstyle';
	var style_cookie_settings = '; path=/; domain=irrlicht.sourceforge.net';
	var onload_functions = new Array();
	var onunload_functions = new Array();

	

	/**
	* Find a member
	*/
	function find_username(url)
	{
		popup(url, 760, 570, '_usersearch');
		return false;
	}

	/**
	* New function for handling multiple calls to window.onload and window.unload by pentapenguin
	*/
	window.onload = function()
	{
		for (var i = 0; i < onload_functions.length; i++)
		{
			eval(onload_functions[i]);
		}
	}

	window.onunload = function()
	{
		for (var i = 0; i < onunload_functions.length; i++)
		{
			eval(onunload_functions[i]);
		}
	}

// ]]>
</script>
<script type="text/javascript" src="./styles/prosilver/template/styleswitcher.js"></script>
<script type="text/javascript" src="./styles/prosilver/template/forum_fn.js"></script>

<link href="./styles/prosilver/theme/print.css" rel="stylesheet" type="text/css" media="print" title="printonly" />
<link href="./style.php?id=1&amp;lang=en&amp;sid=ba7a0815ac695ac3bd2849a4147d3342" rel="stylesheet" type="text/css" media="screen, projection" />

<link href="./styles/prosilver/theme/normal.css" rel="stylesheet" type="text/css" title="A" />
<link href="./styles/prosilver/theme/medium.css" rel="alternate stylesheet" type="text/css" title="A+" />
<link href="./styles/prosilver/theme/large.css" rel="alternate stylesheet" type="text/css" title="A++" />



</head>

<body id="phpbb" class="section-viewtopic ltr">

<div id="wrap">
	<a id="top" name="top" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar">
			<div class="inner"><span class="corners-top"><span></span></span>

			<div id="site-description">
				<a href="./index.php?sid=ba7a0815ac695ac3bd2849a4147d3342" title="Board index" id="logo"><img src="./styles/prosilver/imageset/irrlicht_logo.png" width="256" height="74" alt="" title="" /></a>
				<h1>Irrlicht Engine</h1>
				<p>Official forum of the Irrlicht Engine</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

		
			<div id="search-box">
				<form action="./search.php?sid=ba7a0815ac695ac3bd2849a4147d3342" method="post" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="text" maxlength="128" title="Search for keywords" class="inputbox search" value="Search…" onclick="if(this.value=='Search…')this.value='';" onblur="if(this.value=='')this.value='Search…';" />
					<input class="button2" value="Search" type="submit" /><br />
					<a href="./search.php?sid=ba7a0815ac695ac3bd2849a4147d3342" title="View the advanced search options">Advanced search</a> 
				</fieldset>
				</form>
			</div>
		

			<span class="corners-bottom"><span></span></span></div>
		</div>

		<div class="navbar">
			<div class="inner"><span class="corners-top"><span></span></span>

			<ul class="linklist navlinks">
				<li class="icon-home"><a href="./index.php?sid=ba7a0815ac695ac3bd2849a4147d3342" accesskey="h">Board index</a>  <strong>&#8249;</strong> <a href="./viewforum.php?f=21&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">Irrlicht Programming</a> <strong>&#8249;</strong> <a href="./viewforum.php?f=9&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">Code Snippets</a></li>

				<li class="rightside"><a href="#" onclick="fontsizeup(); return false;" onkeypress="return fontsizeup(event);" class="fontsize" title="Change font size">Change font size</a></li>

				<li class="rightside"><a href="./viewtopic.php?f=9&amp;t=42096&amp;sid=ba7a0815ac695ac3bd2849a4147d3342&amp;view=print" title="Print view" accesskey="p" class="print">Print view</a></li>
			</ul>

			

			<ul class="linklist rightside">
				<li class="icon-faq"><a href="./faq.php?sid=ba7a0815ac695ac3bd2849a4147d3342" title="Frequently Asked Questions">FAQ</a></li>
				<li class="icon-register"><a href="./ucp.php?mode=register&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">Register</a></li>
					<li class="icon-logout"><a href="./ucp.php?mode=login&amp;sid=ba7a0815ac695ac3bd2849a4147d3342" title="Login" accesskey="x">Login</a></li>
				
			</ul>

			<span class="corners-bottom"><span></span></span></div>
		</div>

	</div>

	<a name="start_here"></a>
	<div id="page-body">
		
<h2><a href="./viewtopic.php?f=9&amp;t=42096&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">Hardware Skinning for Irrlicht 1.7</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body --><div style="display: none !important;">Post those lines of code you feel like sharing or find what you require for your project here; or simply use them as tutorials.<br /></div>

<div class="topic-actions">

	<div class="buttons">
	
		<div class="reply-icon"><a href="./posting.php?mode=reply&amp;f=9&amp;t=42096&amp;sid=ba7a0815ac695ac3bd2849a4147d3342" title="Post a reply"><span></span>Post a reply</a></div>
	
	</div>

	
		<div class="search-box">
			<form method="post" id="topic-search" action="./search.php?t=42096&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">
			<fieldset>
				<input class="inputbox search tiny"  type="text" name="keywords" id="search_keywords" size="20" value="Search this topic…" onclick="if(this.value=='Search this topic…')this.value='';" onblur="if(this.value=='')this.value='Search this topic…';" />
				<input class="button2" type="submit" value="Search" />
				<input type="hidden" value="42096" name="t" />
				<input type="hidden" value="msgonly" name="sf" />
			</fieldset>
			</form>
		</div>
	
		<div class="pagination">
			23 posts
			 &bull; <a href="#" onclick="jumpto(); return false;" title="Click to jump to page…">Page <strong>1</strong> of <strong>2</strong></a> &bull; <span><strong>1</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=9&amp;t=42096&amp;sid=ba7a0815ac695ac3bd2849a4147d3342&amp;start=15">2</a></span>
		</div>
	

</div>
<div class="clear"></div>


	<div id="p238401" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 class="first"><a href="#p238401">Hardware Skinning for Irrlicht 1.7</a></h3>
			<p class="author"><a href="./viewtopic.php?p=238401&amp;sid=ba7a0815ac695ac3bd2849a4147d3342#p238401"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">christianclavet</a></strong> &raquo; Thu Nov 25, 2010 1:07 pm </p>

			

			<div class="content">(Edited 11/27/2010)
<br />Hi, I've been asking this feature but it's not fully ready now.
<br />
<br /><span style="font-weight: bold">Blindside</span> created a vertex shader that could do this and submitted it to the forum. The version submitted had memory leaks, that I fixed. 
<br />BlindSide used it only to check if it worked. Most of the code here are based on Blindside work and the class instancing trick came from Andres. <span style="font-weight: bold">FMX</span> had removed the lighting from the test so we could really see the Skinning performance, that was really nice. So now you can choose to check with or without lighting.
<br />
<br />I've made it work in Irrlicht 1.7.2 (Should also work on 1.7.1), and then created separate files to use as include, so we could only issue <span style="text-decoration: underline">a simple </span>command to activate that feature on our Skinned model.
<br />
<br />So to use this with your own skinned meshes, you only need to do this:
<br />
<br />1. Add the include:
<br /><dl class="codebox"><dt> Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>#include &quot;HardwareSkinCallback.h&quot;</code></dd></dl><br /><br />2. Setup the mesh. You only need to input your device and your animated mesh to activate it. (before the run loop)<br /><dl class="codebox"><dt> Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>HWSkinCB::getInstance&#40;&#41;-&gt;setupNode&#40;device,dwarf&#41;;</code></dd></dl>
<br />
<br />The current example show now 36 Dwarves to check the performance on crowds. Since I would use this feature mostly for this.
<br /><img src="http://www.clavet.org/blog/sites/default/files/images/Skinning.jpg" alt="Image" />
<br />
<br />Current performance on my system (EVGA NVidia GTX 460, 2,66Ghz Quad Core Intel, OS: VISTA):
<br /><span style="font-style: italic">Drawing 36 dwarfs (6 x 6)</span>
<br /><span style="font-weight: bold">OpenGL</span>
<br />494 FPS No vertex lighting + Hardware Skinning
<br />170 FPS Vertex Lighting + Hardware Skinning
<br />110 FPS No lighting + Software Skinning
<br />108 FPS Lighting + Software skinning
<br />303 FPS Skinning disabled
<br />
<br /><span style="font-weight: bold">DirectX 9</span>
<br />585 FPS No vertex lighting + Harware Skinning
<br />353 FPS Vertex Lighting + Hardware Skinning
<br />121 FPS No lighting + Software skinning
<br />----       Lighting + Software skinning not working (no lights on the model)
<br />381 FPS Skinning disabled
<br />
<br />Current limits:
<br />8 Lights
<br />80 Joints max for OpenGL
<br />57 joints max for DirectX
<br />
<br /><span style="color: red">[WARNING]</span> - Blindslide shader code seem to work only on GLSL 4.0! (As my primary PC), tested it on my HTPC (Radeon 4350 - Pentium - Glsl 3.3) and the shader give 9 errors and fail to compile! Found out after Lazerblade message... We'll need to convert the shader to a lesser version of OpenGL as my current knowledge of shader is insuficient to do the task. Until then, the open GL version will only work on very recent cards... (I wonder how could shadowlair could have tested openGL?!)
<br />
<br />Exemple set at 1/60 refresh interval for the shader callback. You can disable the refresh by putting 0 in the parameter. (milliseconds)
<br />
<br />I've created an MSVC (2008) project with all the files (also the shaders). The shaders are (DX hlsl and GL glsl). I've tested them both and did not see memory leaks. The archive also contain a binary so it will be easier to check.
<br />
<br />This would really take advantage of your video card shaders processing power, but It would be surely pointless to use on a old (before they came in unified architecture) or really weak (integrated). If your system can't run a recent game, then this will not give you a big improvement... 
<br />
<br />You can download it here: (1.48Mb) <a href="http://www.clavet.org/files/Hardware_Skinning.zip" class="postlink">http://www.clavet.org/files/Hardware_Skinning.zip</a> (Last update 26/11/2010)
<br />
<br />Thank a lot to BlindSide and FMX for providing the code and the shaders!</div>

			
				<div class="notice">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">christianclavet</a> on Mon Nov 29, 2010 6:46 pm, edited 14 times in total.
					
				</div>
			<div id="sig238401" class="signature">Current projects:
<br /><img src="http://irrrpgbuilder.sourceforge.net/images/logo.png" alt="Image" />
<br /><a href="http://irrrpgbuilder.sourceforge.net/" class="postlink">http://irrrpgbuilder.sourceforge.net/</a>
<br /><a href="http://first-king.sourceforge.net" class="postlink">http://first-king.sourceforge.net</a></div>

		</div>

		
			<dl class="postprofile" id="profile238401">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342"><img src="http://www.clavet.org/files/images/CCavatar.jpg" width="80" height="80" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">christianclavet</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 1187</dd><dd><strong>Joined:</strong> Mon Apr 30, 2007 3:24 am</dd><dd><strong>Location:</strong> Montreal, CANADA</dd>
			<dd>
				<ul class="profile-icons">
					<li class="web-icon"><a href="http://www.clavet.org" title="WWW: http://www.clavet.org"><span>Website</span></a></li>
				</ul>
			</dd>
		

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p238409" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p238409"></a></h3>
			<p class="author"><a href="./viewtopic.php?p=238409&amp;sid=ba7a0815ac695ac3bd2849a4147d3342#p238409"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=15337&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">shadowslair</a></strong> &raquo; Thu Nov 25, 2010 3:59 pm </p>

			

			<div class="content">Haha! 
<br />With: 580 fps
<br />Without: 830 fps
<br />Conclusion: my hardware sucks! =/
<br /> <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />
<br />
<br />EDIT: And I wonder what`s the benefit from the &quot;GetInstance()&quot;  method? What`s the problem calling &quot;new&quot; and keeping the pointer? Seems pointless to me. And I don`t see where you drop the device (&quot;createDevice&quot;) and the so precious HwSkinCallback pointer? <img src="./images/smilies/icon_rolleyes.gif" alt=":roll:" title="Rolling Eyes" /></div>

			<div id="sig238409" class="signature"><img src="http://img831.imageshack.us/img831/2026/btstudio2jpg.jpg" alt="Image" />
<br />&quot;Although we walk on the ground and step in the mud... our dreams and endeavors reach the immense skies...&quot;</div>

		</div>

		
			<dl class="postprofile" id="profile238409">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=15337&amp;sid=ba7a0815ac695ac3bd2849a4147d3342"><img src="http://img151.imageshack.us/img151/6103/bloodtearslogo390x90jpg.jpg" width="80" height="80" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=15337&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">shadowslair</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 718</dd><dd><strong>Joined:</strong> Mon Mar 31, 2008 3:32 pm</dd><dd><strong>Location:</strong> Bulgaria</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p238427" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p238427"></a></h3>
			<p class="author"><a href="./viewtopic.php?p=238427&amp;sid=ba7a0815ac695ac3bd2849a4147d3342#p238427"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">christianclavet</a></strong> &raquo; Thu Nov 25, 2010 8:56 pm </p>

			

			<div class="content">Hi, I improved the demo a little. Since it's about hardware skinning, I think we should see more difference over a batch of characters instead of a single one. The class now also hint the mesh as dynamic (EHM_DYNAMIC). Hoping to get more performance with the VBO.
<br />
<br /><img src="http://www.clavet.org/blog/sites/default/files/images/Skinning.jpg" alt="Image" />
<br />
<br />Shadowlair, the &quot;getInstance&quot; will allow me to retrieve the instance of the class that is kept inside a static pointer. (I think it work as a cheap singleton).  Doing a new would surely work, but this was simpler to me.
<br />
<br />Thanks for your inputs, you were right, I was not dropping the device in the main.cpp. I added it, but I doubt it will go there (as it goes thru an infinite loop). Anyway its alway good to have it. I also updated a little the class, to have a check for the mesh when it goes into the callback and better clearing of the pointers (arrays) and added the destructor. Checked again my memory for any sign of leaks, and did not see anything. (1,56Gb used and after 15 min 1,56Gb). If you have ideas to propose, we could improve this further...
<br />
<br />This should also work now in a subclass as in that thread (if you use this with other shaders):
<br /><!-- m --><a class="postlink" href="http://irrlicht.sourceforge.net/phpBB2/viewtopic.php?t=34253">http://irrlicht.sourceforge.net/phpBB2/ ... hp?t=34253</a><!-- m -->
<br />
<br />
<br />I simply replaced the archive, and it's about the same size. Check the link in the first post.
<br />
<br />[EDIT] Done some tests here in OpenGl.
<br />Non animated mesh (all skinning disabled) = 255 FPS
<br />Skinned mesh (hardware) = 155 FPS
<br />Skinned mesh (software)  = 103 FPS
<br />
<br />I wonder if there is a way to get even more performance (lost 100 FPS only activating the hardware skinning on the 36 dwarfs)
<br />
<br />Also is there a way to increase the limit for the maximum number of joints to be at least 80? My test with a 3DS biped show 71 joints (I had around 30 bones) (There is a limit set inside the shader itself). Right now the limit set by BlindSide is 55 joints.</div>

			
				<div class="notice">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">christianclavet</a> on Thu Nov 25, 2010 10:50 pm, edited 5 times in total.
					
				</div>
			<div id="sig238427" class="signature">Current projects:
<br /><img src="http://irrrpgbuilder.sourceforge.net/images/logo.png" alt="Image" />
<br /><a href="http://irrrpgbuilder.sourceforge.net/" class="postlink">http://irrrpgbuilder.sourceforge.net/</a>
<br /><a href="http://first-king.sourceforge.net" class="postlink">http://first-king.sourceforge.net</a></div>

		</div>

		
			<dl class="postprofile" id="profile238427">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342"><img src="http://www.clavet.org/files/images/CCavatar.jpg" width="80" height="80" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">christianclavet</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 1187</dd><dd><strong>Joined:</strong> Mon Apr 30, 2007 3:24 am</dd><dd><strong>Location:</strong> Montreal, CANADA</dd>
			<dd>
				<ul class="profile-icons">
					<li class="web-icon"><a href="http://www.clavet.org" title="WWW: http://www.clavet.org"><span>Website</span></a></li>
				</ul>
			</dd>
		

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p238430" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p238430"></a></h3>
			<p class="author"><a href="./viewtopic.php?p=238430&amp;sid=ba7a0815ac695ac3bd2849a4147d3342#p238430"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=19121&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">lazerblade</a></strong> &raquo; Thu Nov 25, 2010 10:15 pm </p>

			

			<div class="content">Yay!!!!   <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />
<br />
<br />This saved me from switching rendering engines.  <img src="./images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /></div>

			<div id="sig238430" class="signature">LazerBlade
<br />
<br />When your mind is racing, make sure it's not racing in a circle.
<br />
<br />3d game engine: <a href="http://sites.google.com/site/lazerbladegames/home/ray3d" class="postlink">http://sites.google.com/site/lazerbladegames/home/ray3d</a>
<br />lazerBlade blog: <a href="http://lazerbladegames.blogspot.com/" class="postlink">http://lazerbladegames.blogspot.com/</a></div>

		</div>

		
			<dl class="postprofile" id="profile238430">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=19121&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">lazerblade</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 193</dd><dd><strong>Joined:</strong> Thu Mar 18, 2010 3:31 am</dd>
			<dd>
				<ul class="profile-icons">
					<li class="web-icon"><a href="http://sites.google.com/site/lazerbladegames/" title="WWW: http://sites.google.com/site/lazerbladegames/"><span>Website</span></a></li>
				</ul>
			</dd>
		

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p238440" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p238440"></a></h3>
			<p class="author"><a href="./viewtopic.php?p=238440&amp;sid=ba7a0815ac695ac3bd2849a4147d3342#p238440"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=10860&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">fmx</a></strong> &raquo; Fri Nov 26, 2010 10:32 am </p>

			

			<div class="content">I had a quick look at this, spotted something you should be aware of:
<br />there is no need to worry about 8 light-sources in your implementation just yet!
<br />
<br />The Hardware-Shader callback has to send 8*3+8*4=56 floats to the shader for every model, every frame. 
<br />Not only are these constants (so can be precomputed and passed to the shaders only once per frame) but they can be compressed easily into shorts or bytes, no need for floats.
<br />
<br />Commenting out the light-information lines immediately doubled the FPS of your hardware-skinning implementation on my system, which is good enough to impress even the most cynical of programmers <img src="./images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /> 
<br />
<br />In <span style="font-weight: bold">HardwareSkinCallback.cpp</span>
<br /><dl class="codebox"><dt> Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>/*<br />&nbsp; &nbsp;&nbsp; &nbsp;f32* lightPosArray = new f32&#91;8 * 3&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;f32* lightPosArrayPtr = lightPosArray;<br />&nbsp; &nbsp;&nbsp; &nbsp;f32* lightColArray = new f32&#91;8 * 4&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;f32* lightColArrayPtr = lightColArray;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;for&#40;u32 i = 0; i &lt; 8;++i&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40;i &lt; services-&gt;getVideoDriver&#40;&#41;-&gt;getDynamicLightCount&#40;&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;vector3df lightPos = services-&gt;getVideoDriver&#40;&#41;-&gt;getDynamicLight&#40;i&#41;.Position;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;SColorf lightCol = services-&gt;getVideoDriver&#40;&#41;-&gt;getDynamicLight&#40;i&#41;.DiffuseColor;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightPosArray&#91;0&#93; = lightPos.X;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightPosArray&#91;1&#93; = lightPos.Y;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightPosArray&#91;2&#93; = lightPos.Z;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightPosArray += 3;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightColArray&#91;0&#93; = lightCol.r;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightColArray&#91;1&#93; = lightCol.g;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightColArray&#91;2&#93; = lightCol.b;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightColArray&#91;3&#93; = lightCol.a;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightColArray += 4;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightPosArray&#91;0&#93; = 0;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightPosArray&#91;1&#93; = 0;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightPosArray&#91;2&#93; = 0;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightPosArray += 3;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightColArray&#91;0&#93; = 0;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightColArray&#91;1&#93; = 0;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightColArray&#91;2&#93; = 0;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightColArray&#91;3&#93; = 0;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lightColArray += 4;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;services-&gt;setVertexShaderConstant&#40;&quot;lightPosArray&quot;, &amp;lightPosArrayPtr&#91;0&#93;, 8 * 3&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;services-&gt;setVertexShaderConstant&#40;&quot;lightColorArray&quot;, &amp;lightColArrayPtr&#91;0&#93;, 8 * 4&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;delete &#40;lightPosArrayPtr&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;delete &#40;lightColArrayPtr&#41;;<br />*/<br /></code></dd></dl></div>

			

		</div>

		
			<dl class="postprofile" id="profile238440">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=10860&amp;sid=ba7a0815ac695ac3bd2849a4147d3342"><img src="http://img820.imageshack.us/img820/4485/iravo.jpg" width="80" height="80" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=10860&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">fmx</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 416</dd><dd><strong>Joined:</strong> Wed Dec 06, 2006 9:28 am</dd><dd><strong>Location:</strong> UK</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p238442" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p238442"></a></h3>
			<p class="author"><a href="./viewtopic.php?p=238442&amp;sid=ba7a0815ac695ac3bd2849a4147d3342#p238442"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=5010&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">Bear_130278</a></strong> &raquo; Fri Nov 26, 2010 10:45 am </p>

			

			<div class="content">With: 23 fps
<br />Without: 47 fps 
<br />Lol <img src="./images/smilies/icon_cool.gif" alt="8)" title="Cool" />)</div>

			<div id="sig238442" class="signature">Do you like VODKA???
<br /><img src="http://img5.imageshack.us/img5/4181/russia6.gif" alt="Image" />
<br /><a href="http://irrlicht.sourceforge.net/phpBB2/viewtopic.php?t=38082" class="postlink"><img src="http://img188.imageshack.us/img188/3076/forumal.jpg" alt="Image" /></a></div>

		</div>

		
			<dl class="postprofile" id="profile238442">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=5010&amp;sid=ba7a0815ac695ac3bd2849a4147d3342"><img src="http://img340.imageshack.us/img340/9674/5avat.jpg" width="80" height="80" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=5010&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">Bear_130278</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 237</dd><dd><strong>Joined:</strong> Mon Jan 16, 2006 1:18 pm</dd><dd><strong>Location:</strong> Odessa,Russian Federation</dd>
			<dd>
				<ul class="profile-icons">
					<li class="icq-icon"><a href="http://www.icq.com/people/webmsg.php?to=176106798" onclick="popup(this.href, 550, 320); return false;" title="ICQ"><span>ICQ</span></a></li>
				</ul>
			</dd>
		

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p238443" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p238443"></a></h3>
			<p class="author"><a href="./viewtopic.php?p=238443&amp;sid=ba7a0815ac695ac3bd2849a4147d3342#p238443"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=11054&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">Virion</a></strong> &raquo; Fri Nov 26, 2010 11:08 am </p>

			

			<div class="content">can someone share his compiled binary? i'm lazy to compile but i would like to do the testing.</div>

			

		</div>

		
			<dl class="postprofile" id="profile238443">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=11054&amp;sid=ba7a0815ac695ac3bd2849a4147d3342"><img src="http://a.imageshack.us/img132/2029/31298408951027611539367.jpg" width="80" height="80" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=11054&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">Virion</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 1988</dd><dd><strong>Joined:</strong> Mon Dec 18, 2006 5:04 am</dd><dd><strong>Location:</strong> Asia</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p238444" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p238444"></a></h3>
			<p class="author"><a href="./viewtopic.php?p=238444&amp;sid=ba7a0815ac695ac3bd2849a4147d3342#p238444"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=10860&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">fmx</a></strong> &raquo; Fri Nov 26, 2010 12:05 pm </p>

			

			<div class="content">after making some changes, I get
<br />
<br />DX
<br />without HWS: 108 fps
<br />with HWS: 280 fps
<br />
<br />GL
<br />without HWS: 106 fps
<br />with HWS: 402 fps
<br />
<br />I commented out all lighting calculation code in the source and shaders, and set GL to use VS_2 instead of VS_3</div>

			
				<div class="notice">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=10860&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">fmx</a> on Mon Nov 29, 2010 4:39 pm, edited 1 time in total.
					
				</div>
			

		</div>

		
			<dl class="postprofile" id="profile238444">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=10860&amp;sid=ba7a0815ac695ac3bd2849a4147d3342"><img src="http://img820.imageshack.us/img820/4485/iravo.jpg" width="80" height="80" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=10860&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">fmx</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 416</dd><dd><strong>Joined:</strong> Wed Dec 06, 2006 9:28 am</dd><dd><strong>Location:</strong> UK</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p238452" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p238452"></a></h3>
			<p class="author"><a href="./viewtopic.php?p=238452&amp;sid=ba7a0815ac695ac3bd2849a4147d3342#p238452"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">christianclavet</a></strong> &raquo; Fri Nov 26, 2010 4:22 pm </p>

			

			<div class="content">Thanks FMX. 
<br />
<br />Ok. the info there seemed mostly for directx. I've not seen that applied when in OpenGL. A more flexible vertex format would surely handle both the vertex lighting and the skinning. Thanks a lot for explaining!
<br />
<br />Have you seen if there is a way to increase the joint count since we're not using the lighting anymore? I would need at least 71 joints (3DS MAX base Biped) and the max default set are 55.
<br />
<br />Now with the current changes, there is no vertex lighting but my frame rate has gone to <span style="font-weight: bold">370FPS</span> with hardware skinning(GL), and 110FPS without. <span style="text-decoration: underline">It's showing a major increase</span>! 
<br />
<br />From this, I'd like to try to limit the constant refresh to 1/60 sec with a timer check and see if it will go even faster. <img src="./images/smilies/icon_twisted.gif" alt=":twisted:" title="Twisted Evil" />
<br />
<br />Thanks for sharing!
<br />
<br /><span style="font-weight: bold">[EDIT]</span>
<br />Wow! It worked!! <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />
<br />Refreshing the constants at 60FPS increased the rendering speed to <span style="font-weight: bold">535 FPS!!!</span> So the shader contant refresh now are done on a 60FPS interval but the rendering speed is boosted. I don't see any slowdown or lag in the animation. (why would we need animations refresh faster than 60FPS anyway!)
<br />
<br />I added your changes to the code and also added a new parameter when we set the mesh, we can now define the refresh interval to update the constant of the shader. In the example, in main.cpp. For the Dwarf, I set the refresh to 60FPS by putting 17ms in the parameter.
<br />
<br />This could serve for example if your have far away characters, you could lower even more their animation refresh to gain more FPS. (Perhaps adding another command to change the refresh interval once the mesh is set)
<br />
<br />The archive has also been updated with a binary so you will not have to recompile it to check it out. Check the first post. And thanks again FMX!
<br /><span style="font-weight: bold">[EDIT] </span>Found a little problem in DX, fixed it and updated the archive again. If you test DX and have a problem, download the updated archive.</div>

			<div id="sig238452" class="signature">Current projects:
<br /><img src="http://irrrpgbuilder.sourceforge.net/images/logo.png" alt="Image" />
<br /><a href="http://irrrpgbuilder.sourceforge.net/" class="postlink">http://irrrpgbuilder.sourceforge.net/</a>
<br /><a href="http://first-king.sourceforge.net" class="postlink">http://first-king.sourceforge.net</a></div>

		</div>

		
			<dl class="postprofile" id="profile238452">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342"><img src="http://www.clavet.org/files/images/CCavatar.jpg" width="80" height="80" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">christianclavet</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 1187</dd><dd><strong>Joined:</strong> Mon Apr 30, 2007 3:24 am</dd><dd><strong>Location:</strong> Montreal, CANADA</dd>
			<dd>
				<ul class="profile-icons">
					<li class="web-icon"><a href="http://www.clavet.org" title="WWW: http://www.clavet.org"><span>Website</span></a></li>
				</ul>
			</dd>
		

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p238459" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p238459"></a></h3>
			<p class="author"><a href="./viewtopic.php?p=238459&amp;sid=ba7a0815ac695ac3bd2849a4147d3342#p238459"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=20037&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">macron12388</a></strong> &raquo; Fri Nov 26, 2010 8:42 pm </p>

			

			<div class="content">That is a good increase in performance! Yet, like you said, why would we need something that refreshes that fast, I doubt many people have monitors that refresh at more than 60/70htz. Still, that pool of extra performance is nice to have, you can pull from that and add some other resource expensive features, and you can keep it at 60 fps.</div>

			

		</div>

		
			<dl class="postprofile" id="profile238459">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=20037&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">macron12388</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 126</dd><dd><strong>Joined:</strong> Wed Sep 29, 2010 8:23 pm</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p238462" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p238462"></a></h3>
			<p class="author"><a href="./viewtopic.php?p=238462&amp;sid=ba7a0815ac695ac3bd2849a4147d3342#p238462"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=15337&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">shadowslair</a></strong> &raquo; Fri Nov 26, 2010 9:00 pm </p>

			

			<div class="content">There should be sth wrong with the latest version, christianclavet - with <span style="font-weight: bold">fmx</span>`s version I get:
<br /><span style="font-weight: bold">without 37 -&gt; 84 with</span>
<br />with <span style="font-weight: bold">yours</span> I get:
<br /><span style="font-weight: bold">without 37 -&gt; 39 with</span>
<br /> <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>

			<div id="sig238462" class="signature"><img src="http://img831.imageshack.us/img831/2026/btstudio2jpg.jpg" alt="Image" />
<br />&quot;Although we walk on the ground and step in the mud... our dreams and endeavors reach the immense skies...&quot;</div>

		</div>

		
			<dl class="postprofile" id="profile238462">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=15337&amp;sid=ba7a0815ac695ac3bd2849a4147d3342"><img src="http://img151.imageshack.us/img151/6103/bloodtearslogo390x90jpg.jpg" width="80" height="80" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=15337&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">shadowslair</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 718</dd><dd><strong>Joined:</strong> Mon Mar 31, 2008 3:32 pm</dd><dd><strong>Location:</strong> Bulgaria</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p238464" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p238464"></a></h3>
			<p class="author"><a href="./viewtopic.php?p=238464&amp;sid=ba7a0815ac695ac3bd2849a4147d3342#p238464"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">christianclavet</a></strong> &raquo; Fri Nov 26, 2010 9:54 pm </p>

			

			<div class="content">Hi, Shadowlair.
<br />
<br />Surely, the timer check that take too much time on your 'little card' the call to check the timer eat too much fps. Do you have something integrated? What is your type of video card? If you can recompile can you set the refresh to 0ms to see if it improve? (This is in main.cpp, when you set the mesh)
<br />
<br />I've updated again the version, so we can enable back again the vertex lighting. Just to set the material flag to EMF_LIGHTING to true and the shader will use back lighting. When you lauch the exemple, you now have a choice to check it with or without lighting (vertex). I had to create a separate shader for GL because the boolean check was eating lot of FPS (I lost almost 40FPS just to check for enabling the lighting). I did not lost any fps using separate shaders.
<br />
<br />I've added another test option, is to check with skinning completely disabled (nor software nor hardware). That should give and idea if the meshes were completly static. With that enabled, I saw that the FPS was lower than if I activate the hardware skinning... (250FPS, 500+ with Hardware skinning)
<br />
<br />For some reason, the GL shader seem to support more joints than the DX shader. I was able to set the max to 80 joints (tested with my Biped mesh and the skinning was ok). It still work with DX but the skinning is affected. (Max I was able to reach is 57 joints)</div>

			<div id="sig238464" class="signature">Current projects:
<br /><img src="http://irrrpgbuilder.sourceforge.net/images/logo.png" alt="Image" />
<br /><a href="http://irrrpgbuilder.sourceforge.net/" class="postlink">http://irrrpgbuilder.sourceforge.net/</a>
<br /><a href="http://first-king.sourceforge.net" class="postlink">http://first-king.sourceforge.net</a></div>

		</div>

		
			<dl class="postprofile" id="profile238464">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342"><img src="http://www.clavet.org/files/images/CCavatar.jpg" width="80" height="80" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">christianclavet</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 1187</dd><dd><strong>Joined:</strong> Mon Apr 30, 2007 3:24 am</dd><dd><strong>Location:</strong> Montreal, CANADA</dd>
			<dd>
				<ul class="profile-icons">
					<li class="web-icon"><a href="http://www.clavet.org" title="WWW: http://www.clavet.org"><span>Website</span></a></li>
				</ul>
			</dd>
		

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p238465" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p238465"></a></h3>
			<p class="author"><a href="./viewtopic.php?p=238465&amp;sid=ba7a0815ac695ac3bd2849a4147d3342#p238465"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=11054&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">Virion</a></strong> &raquo; Fri Nov 26, 2010 10:12 pm </p>

			

			<div class="content">thx for the binary.
<br />
<br />DX, with: 145
<br />DX, without: 110
<br />
<br />OGL, with: 340
<br />OGL, without: 100</div>

			

		</div>

		
			<dl class="postprofile" id="profile238465">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=11054&amp;sid=ba7a0815ac695ac3bd2849a4147d3342"><img src="http://a.imageshack.us/img132/2029/31298408951027611539367.jpg" width="80" height="80" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=11054&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">Virion</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 1988</dd><dd><strong>Joined:</strong> Mon Dec 18, 2006 5:04 am</dd><dd><strong>Location:</strong> Asia</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p238466" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p238466"></a></h3>
			<p class="author"><a href="./viewtopic.php?p=238466&amp;sid=ba7a0815ac695ac3bd2849a4147d3342#p238466"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=15337&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">shadowslair</a></strong> &raquo; Fri Nov 26, 2010 10:57 pm </p>

			

			<div class="content"><blockquote><div><cite>christianclavet wrote:</cite>Hi, Shadowlair. Surely, the timer check that take too much time on your 'little card' the call to check the timer eat too much fps. Do you have something integrated? What is your type of video card? If you can recompile can you set the refresh to 0ms to see if it improve? (This is in main.cpp, when you set the mesh)<br /></div></blockquote> Hi. Card is Radeon 9550 =). Too late to compile it right now. Just wondered what was the reason. Maybe will compile it later.  <img src="./images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /></div>

			<div id="sig238466" class="signature"><img src="http://img831.imageshack.us/img831/2026/btstudio2jpg.jpg" alt="Image" />
<br />&quot;Although we walk on the ground and step in the mud... our dreams and endeavors reach the immense skies...&quot;</div>

		</div>

		
			<dl class="postprofile" id="profile238466">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=15337&amp;sid=ba7a0815ac695ac3bd2849a4147d3342"><img src="http://img151.imageshack.us/img151/6103/bloodtearslogo390x90jpg.jpg" width="80" height="80" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=15337&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">shadowslair</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 718</dd><dd><strong>Joined:</strong> Mon Mar 31, 2008 3:32 pm</dd><dd><strong>Location:</strong> Bulgaria</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p238473" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p238473"></a></h3>
			<p class="author"><a href="./viewtopic.php?p=238473&amp;sid=ba7a0815ac695ac3bd2849a4147d3342#p238473"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">christianclavet</a></strong> &raquo; Sat Nov 27, 2010 12:32 am </p>

			

			<div class="content">Yep! That explain all. That card was released in 2004! Seem to work with a fixed pipeline architecture and not the unified architecture as the new card now.
<br />
<br />Here some of the specs from the AMD site:
<br /><blockquote class="uncited"><div>4 parallel pixel pipelines <br />2 programmable vertex shader pipelines <br />128-bit dual-channel DDR memory interface <br /><br /><span style="font-weight: bold">DirectX® 9.0 Vertex Shaders </span><br />                    Vertex programs up to 65,280 instructions with flow control <br /><span style="font-weight: bold">DirectX® 9.0 Pixel Shaders </span><br />                    Up to 1,536 instructions and 16 textures per rendering pass <br />                    32 temporary and constant registers <br />                    128-bit, 64-bit &amp; 32-bit per pixel floating point color formats <br />                    Multiple Render Target (MRT) support <br />Complete feature set also supported in OpenGL® via extensions </div></blockquote>
<br />
<br />I would not recommend using this for this type of card. I was even surprised you got better performance! I doubt it could run Crysis!  <img src="./images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" />
<br />With a refresh of 0ms on this card it should get near FMX (Almost the same exept the check). Nice to know that it can even improve performance on theses old cards!</div>

			<div id="sig238473" class="signature">Current projects:
<br /><img src="http://irrrpgbuilder.sourceforge.net/images/logo.png" alt="Image" />
<br /><a href="http://irrrpgbuilder.sourceforge.net/" class="postlink">http://irrrpgbuilder.sourceforge.net/</a>
<br /><a href="http://first-king.sourceforge.net" class="postlink">http://first-king.sourceforge.net</a></div>

		</div>

		
			<dl class="postprofile" id="profile238473">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342"><img src="http://www.clavet.org/files/images/CCavatar.jpg" width="80" height="80" alt="User avatar" /></a><br />
				<a href="./memberlist.php?mode=viewprofile&amp;u=12918&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">christianclavet</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 1187</dd><dd><strong>Joined:</strong> Mon Apr 30, 2007 3:24 am</dd><dd><strong>Location:</strong> Montreal, CANADA</dd>
			<dd>
				<ul class="profile-icons">
					<li class="web-icon"><a href="http://www.clavet.org" title="WWW: http://www.clavet.org"><span>Website</span></a></li>
				</ul>
			</dd>
		

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<form id="viewtopic" method="post" action="./viewtopic.php?f=9&amp;t=42096&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">

	<fieldset class="display-options" style="margin-top: 0; ">
		<a href="./viewtopic.php?f=9&amp;t=42096&amp;sid=ba7a0815ac695ac3bd2849a4147d3342&amp;start=15" class="right-box right">Next</a>
		<label>Display posts from previous: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
		<label>Sort by <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label> <label><select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select> <input type="submit" name="sort" value="Go" class="button2" /></label>
		
	</fieldset>

	</form>
	<hr />


<div class="topic-actions">
	<div class="buttons">
	
		<div class="reply-icon"><a href="./posting.php?mode=reply&amp;f=9&amp;t=42096&amp;sid=ba7a0815ac695ac3bd2849a4147d3342" title="Post a reply"><span></span>Post a reply</a></div>
	
	</div>

	
		<div class="pagination">
			23 posts
			 &bull; <a href="#" onclick="jumpto(); return false;" title="Click to jump to page…">Page <strong>1</strong> of <strong>2</strong></a> &bull; <span><strong>1</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=9&amp;t=42096&amp;sid=ba7a0815ac695ac3bd2849a4147d3342&amp;start=15">2</a></span>
		</div>
	
</div>


	<p></p><p><a href="./viewforum.php?f=9&amp;sid=ba7a0815ac695ac3bd2849a4147d3342" class="left-box left" accesskey="r">Return to Code Snippets</a></p>

	<form method="post" id="jumpbox" action="./viewforum.php?sid=ba7a0815ac695ac3bd2849a4147d3342" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	
		<fieldset class="jumpbox">
	
			<label for="f" accesskey="j">Jump to:</label>
			<select name="f" id="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">
			
				<option value="-1">Select a forum</option>
			<option value="-1">------------------</option>
				<option value="20">Irrlicht Help</option>
			
				<option value="1">&nbsp; &nbsp;Beginners Help</option>
			
				<option value="4">&nbsp; &nbsp;Advanced Help</option>
			
				<option value="5">&nbsp; &nbsp;FAQs, Tutorials, Howtos, and external tool lists</option>
			
				<option value="21">Irrlicht Programming</option>
			
				<option value="9" selected="selected">&nbsp; &nbsp;Code Snippets</option>
			
				<option value="7">&nbsp; &nbsp;Bug reports</option>
			
				<option value="14">&nbsp; &nbsp;Jirr</option>
			
				<option value="22">Other Irrlicht Stuff</option>
			
				<option value="6">&nbsp; &nbsp;Project Announcements</option>
			
				<option value="10">&nbsp; &nbsp;Competition Time!</option>
			
				<option value="2">&nbsp; &nbsp;Open Discussion and Dev Announcements</option>
			
				<option value="3">&nbsp; &nbsp;Off-topic</option>
			
				<option value="23">Game Development</option>
			
				<option value="18">&nbsp; &nbsp;Everything 2d/3d Graphics</option>
			
				<option value="19">&nbsp; &nbsp;Game Programming</option>
			
				<option value="24">Locked Forums</option>
			
				<option value="8">&nbsp; &nbsp;Irrlicht.NET</option>
			
			</select>
			<input type="submit" value="Go" class="button2" />
		</fieldset>
	</form>


	<h3>Who is online</h3>
	<p>Users browsing this forum: No registered users and 1 guest</p>
</div>

<div id="page-footer">

	<div class="navbar">
		<div class="inner"><span class="corners-top"><span></span></span>

		<ul class="linklist">
			<li class="icon-home"><a href="./index.php?sid=ba7a0815ac695ac3bd2849a4147d3342" accesskey="h">Board index</a></li>
				
			<li class="rightside"><a href="./memberlist.php?mode=leaders&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">The team</a> &bull; <a href="./ucp.php?mode=delete_cookies&amp;sid=ba7a0815ac695ac3bd2849a4147d3342">Delete all board cookies</a> &bull; All times are UTC </li>
		</ul>

		<span class="corners-bottom"><span></span></span></div>
	</div>

<!--
	We request you retain the full copyright notice below including the link to www.phpbb.com.
	This not only gives respect to the large amount of time given freely by the developers
	but also helps build interest, traffic and use of phpBB3. If you (honestly) cannot retain
	the full copyright we ask you at least leave in place the "Powered by phpBB" line, with
	"phpBB" linked to www.phpbb.com. If you refuse to include even this then support on our
	forums may be affected.

	The phpBB Group : 2006
//-->

	<div class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a> &copy; 2000, 2002, 2005, 2007 phpBB Group
		
	</div>
</div>

</div>

<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
	
</div>

</body>
</html>